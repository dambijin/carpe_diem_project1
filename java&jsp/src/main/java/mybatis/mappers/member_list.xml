<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.member_list">

<!-- 	<select id="selectEmp" resultType="empDTO4"> -->
<!-- 		select * from emp4 -->
<!-- 	</select> -->

	<!-- 
		<where>는
		바로 다음에 오는 AND나  OR 글씨를 지워줌 : where and a = b에서 where a = b로 만들어줌
		바로 다음에 오는 게 없으면 where 자체를 지워줌
		
		where 1=1로 시작하는 경우도 있음
		그러면 뒤에 오는 조건은 안심하고 and나 or로 시작할 수 있음
		
	 -->

	<!-- 직원 목록을 조회하는 SQL 쿼리를 정의 -->
	<select id="selectMember" parameterType="MemberDTO" resultType="MemberDTO">
	
		select * from member
		<where>
		
			<!-- 이름(ename)이 비어있지 않은 경우 조건을 추가합니다. -->
			<if test="m_pid != null and m_pid != '' ">
<!-- 				and lower(m_pid) like '%' || lower(#{m_pid}) || '%' -->
				and m_pid <![CDATA[ >= ]]> #{m_pid}
			</if> 
			
			<if test="m_id != null and m_id != '' ">
				and lower(m_id) like '%' || lower(#{m_id}) || '%'
			</if>
			
			<if test="m_pw!= null and m_pw != '' ">
				and lower(m_pw) like '%' || lower(#{m_pw}) || '%'
			</if>
			
			<if test="m_name != null and m_name != '' ">
				and lower(m_name) like '%' || lower(#{m_name}) || '%'
			</if>
			
			<if test="m_tel != null and m_tel != '' ">
				and lower(m_tel) like '%' || lower(#{m_tel}) || '%'
			</if>
			
			<!-- type -->
			<if test="type != null and type != '' ">
				<if test="type == 1">
					
				</if>
				<if test="type == 2">123
					and m_pid <![CDATA[ >= ]]> #{keyword}
				</if>
				<if test="type == 3">
					lower(m_name) like '%' || lower(#{keyword}) || '%'
				</if>
				<if test="type == 4">
					and m_id <![CDATA[ >= ]]> #{keyword}
				</if>
				<if test="type == 5">
					and m_tel <![CDATA[ >= ]]> #{keyword}
				</if>
				
			</if>
		</where>
		
		<if test="orderColumn != null and orderColumn != '' and orderType != '' ">
			<if test="orderColumn == 'm_pid' ">
				order by m_pid
				<if test="orderType == 'desc' ">
					desc
				</if>	
				<if test="orderType == 'asc' ">
					asc
				</if>
			</if>
		</if>
		
		
	</select>
	
	
</mapper>