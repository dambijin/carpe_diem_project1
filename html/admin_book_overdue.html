<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연체상태 popup</title>
    <link href="../css/layout.css" rel="stylesheet">
</head>

<!-- function 스크립트 -->
<script src="../js/admin_library.js"></script>
<script>

    window.addEventListener("load", function () {
        bind();
    });


    function bind() {
        // 연체추가 가져오기
        let add = document.querySelector("#over_add");

        add.addEventListener('click', function handle_book() { // 책 추가 클릭이벤트

            // 테이블을 todlist 에 담아둠
            let todolist = document.querySelector("#todo_booktable");

            if (!todolist) {
                console.error("Error: todo_booktable not found.");
                return;
            }

            let book_html = '';

            // html += '</tr>';
            // 추가한다
            book_html += '<td>aaaaaaaaaaa</td>';
            book_html += '<td>홍길동</td>';
            book_html += '<td>천안도서관</td>';
            book_html += '<td>yyyy/mm/dd</td>';
            book_html += '<td>yyyy/mm/dd</td>';
            book_html += '<td>3일</td>';
            book_html += '<td><input type="checkbox" class="check"></td>';
            // html +=	'</tr>'

            let tr = document.createElement("tr"); // <tr></tr>
            tr.innerHTML = book_html;

            todolist.append(tr);
        })

        // 체크박스 
        document.querySelector("#selected_del").addEventListener("click", function () {
            let list_checked = document.querySelectorAll(".check:checked");

            if (list_checked.length > 0) {
                for (let i = 0; i < list_checked.length; i++) {
                    list_checked[i].parentNode.parentNode.remove();
                }
            } else {
                alert("연체해제할 항목을 선택해주세요");
            }
        });

        document.querySelector("#select_all").addEventListener("click", function (event) {
            let list_check = document.querySelectorAll(".check");

            for (let i = 0; i < list_check.length; i++) {
                list_check[i].checked = event.target.checked;
            }
        })
    };

    //폐기버튼 알림창 및 폐기 클릭 시 remove()
    console.log(document.getElementById("selected_del"));

    document.getElementById('selected_del').addEventListener('click', function () {
        let list_checked = document.querySelectorAll(".checkbox:checked");


        if (list_checked.length == 0) {
            alert("폐기할 항목을 선택해주세요.");
        } else if (confirm("선택한 항목을 폐기하시겠습니까?")) {
            for (let i = 0; i < list_checked.length; i++) {
                let listItem = list_checked[i].closest('li'); // 수정된 부분
                if (listItem) {
                    listItem.remove();
                }
            }
            alert("폐기되었습니다.");
        } else {
            alert("선택된 항목이 없습니다.");
        }
    });




</script>

<style>
    header .nav .book_in {
        background-color: rgba(168, 156, 200, 0.6);
        color: #000000;
        height: 45px;
        line-height: 40px;
        display: inline-block;
        border-radius: 5px;
        width: 150px;
        font-size: 20px;
        margin-top: 10px;
    }

    /* section */
    section {
        font-family: "Wanted Sans Variable";
    }

    .add_table {
        border-collapse: collapse;
    }

    .add_table th {
        background-color: rgba(163, 163, 163, 0.6);
    }

    .add_table tr {
        background-color: #fff;
    }

    .add_table tr .bookname {
        width: 500px;
    }

    .add_table th,
    .add_table td {
        border: 1px solid black;
        height: 40px;
        text-align: center;
    }

    /*  등록 취소 버튼 (맨 아래) */
    .input {
        border: 1px;
        width: 20%;
        margin: auto;
        text-align: center;
        margin-top: 20px;
    }

    .input .button {
        font-family: "Wanted Sans Variable";
        font-size: 18px;
        background-color: rgba(71, 125, 231, 0.973);
        border: 0;
        width: 80px;
        height: 30px;
        border-radius: 5px;
        color: white;
    }

    .input .button:hover {
        background-color: rgba(205, 155, 225, 0.6);
    }

    
</style>

<body>
    <!-- header -->
    <header></header>

    <!-- section -->
    <section>
        <div>
            <h2 align="center">연체상태</h2>
        </div>

        <div>
            <button type="button" id="over_add">책 추가</button>
            <table class="add_table" border="0" width="900px" align="center" cellpadding="5" cellspacing="1"
                bgcolor="cccccc" id="todo_booktable">
                <tr>
                    <th>책제목</th>
                    <th>저자</th>
                    <th>소장기관</th>
                    <th>대출일자</th>
                    <th>반납일자</th>
                    <th>연체일자</th>
                    <th width="100px">
                        연체상태
                        <input type="checkbox" name="check" id="select_all">
                    </th>
                </tr>
            </table>
        </div>
    </section>

    <!-- 등록 취소 -->
    <div class="input">
        <button type="button" value="연체해제" class="button" id="selected_del" onclick="overdue_close()">연체해제</button>
        <input type="reset" value="닫기" class="button" onclick="closePopup()">
    </div>



</body>

</html>