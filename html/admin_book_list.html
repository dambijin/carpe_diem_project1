<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>관리자페이지(재고)</title>
	<link href="../css/layout.css" rel="stylesheet">
</head>

<!-- function 스크립트 -->
<script defer src="../js/admin_library.js"></script>
<script>
	// admin_book_list 등록 팝업창열기
	function bookadd_popup() {
		window.open
			("admin_book_add.html", "책 등록", "width=1000, height=800, left=100, top=100");
	}
	// todo 이벤트
	// 책 추가버튼 가져오기
	window.addEventListener("load", function () {
		bind();
	});

	function bind() {
		let add = document.querySelector("#book_add");  // 책 추가 버튼

		// 책 추가 함수 
		add.addEventListener('click', function handle_book() {
			// 테이블을 todlist 에 담아둠
			let todolist = document.querySelector("#todo_booktable");

			if (!todolist) {
				console.error("Error: todo_booktable not found.");
				return;
			}

			let book_html = '';

			// html += '</tr>';
			// 추가한다
			book_html += '<td>java중급</td>';
			book_html += '<td>최민수강사님</td>';
			book_html += '<td>2023-05-01</td>';
			book_html += '<td>12215</td>';
			book_html += '<td>10</td>';
			book_html += '<td>천안도서관</td>';
			book_html += '<td>2024-02-02</td>';
			book_html += '<td>예약</td>';
			book_html += '<td>대출중</td>';
			book_html += '<td><input type="checkbox" name="check" class="checkbox"></td>';
			// html +=	'</tr>'

			let tr = document.createElement("tr"); // <tr></tr>
			tr.innerHTML = book_html;

			// 체크박스 전체선택 중 항목 체크해제시 전체선택 체크박스 해제
			tr.querySelector(".checkbox").addEventListener("click", function (event) {
				// 만약 현재 클릭된 체크박스가 체크 해제되었다면
				if (!event.target.checked) {
					// 전체선택 체크박스도 체크 해제
					document.querySelector("#select_all").checked = false;
				} else {
					// 전체 체크박스 개수와 현재 체크된 체크박스 개수를 세어서 비교
					let allCount = document.querySelectorAll(".checkbox").length;
					let checkedCount = document.querySelectorAll(".checkbox:checked").length;

					// 만약 모든 체크박스가 체크 되어있다면
					if (allCount == checkedCount) {
						// 전체선택 체크박스를 체크
						document.querySelector("#select_all").checked = true;
					} else {
						// else 전체선택 체크박스를 체크 해제
						document.querySelector("#select_all").checked = false;
					}
				}
			});

			// 전체선택 체크 해제
			document.querySelector("#select_all").addEventListener("click", function (event){
				// 클릭된 요소가 check 상태라면
				let list_check = document.querySelectorAll(".checkbox")
				console.log(list_check.length);

				// 체크된 것만
				if (event.target.checked) {
					// 모든 체크박스를 체크
					for (let i = 0; i < list_check.length; i++) {
						list_check[i].checked = true;
					}
				} else {
					// 모든 체크박스를 체크 해제
					for (let i = 0; i < list_check.length; i++) {
						list_check[i].checked = false;
					}
				}
			});
			// 위 코드에서 첫번째 것만
			// 선택 안 잡힘
			todolist.append(tr);

		});





		//폐기버튼 알림창 및 폐기 클릭 시 remove()
		console.log(document.getElementById("button_cancle"));

		document.getElementById('button_cancle').addEventListener('click', function () {
			let list_checked = document.querySelectorAll(".checkbox:checked");


			if (list_checked.length == 0) {
				alert("폐기할 항목을 선택해주세요.");
			} else if (confirm("선택한 항목을 폐기하시겠습니까?")) {
				for (let i = 0; i < list_checked.length; i++) {
					list_checked[i].parentNode.parentNode.remove();
				}
				alert("폐기되었습니다.");
			} else {
				alert("선택된 항목이 없습니다.");
			}
		});

		// 검색에 입력값 받아와 enterkey 작동
		var inputTodo = document.getElementById("input_todo");
		if (inputTodo != null) {
			inputTodo.addEventListener("keydown", enterkey);
		};
	};


	// 10개씩 누를 때 change 이벤트 : 변동이 있을 때 발생
	// 페이징 구현 정하고 기능
	function changeViewCount(count) {
		alert(count + "개씩 보기로 변경되었습니다.");
	};

	// 검색기능
	function search() {
		var textbox = document.getElementById("input_todo");
		if (textbox != null) {
			alert(textbox.value + " ");
		}
	};

	// 엔터 이벤트
	function enterkey() {
		if (window.event.keyCode == 13) {

			// 엔터키가 눌렸을 때 실행하는 반응
			search();
		}
	};

	//나중에 쓸 수 있는 코드	
	// 검색 옵션과 검색 텍스트박스에 입력된 값을 처리하는 함수
	function handleSearchOption() {
		// 검색 옵션 가져옴
        var searchOption = document.getElementById("search_option").value;
		// 검색 텍스트박스 입력값을 가져옴
        var searchTextbox = document.getElementById("input_todo");
        
        // 선택된 옵션에 따라 다르게 동작
        switch (searchOption) {
            case "책이름":
                alert("책이름: " + searchTextbox.value);
                break;
            case "청구기호":
                alert("청구기호: " + searchTextbox.value);
                break;
            case "등록번호":
                alert("등록번호: " + searchTextbox.value);
                break;
            default:
				// 기타 옵션의 경우 아무 동작도 수행하지 않음
                break;
        }
    }
	

</script>

<style>
	header .blank_space .nav .book_inventory {
		background-color: rgba(168, 156, 200, 0.6);
		color: #000000;
		height: 45px;
		line-height: 40px;
		display: inline-block;
		border-radius: 5px;
		width: 150px;
		font-size: 20px;
		margin-top: 10px;
	}

	/*  검색창 */
	.search {
		width: 80%;
		margin: auto;
		text-align: center;
		margin-bottom: 10px;
	}

	.search .search_opt_list {
		width: 80px;
		height: 30px;
	}

	.search .textbox {
		width: 350px;
		height: 20px;
		padding: 2px;
	}

	.search .button {
		font-family: "Wanted Sans Variable";
		font-size: 18px;
		background-color: rgba(155, 178, 225, 0.6);
		width: 50px;
		height: 30px;
		border: 0;
		border-radius: 5px;
	}

	.search .button:hover {
		background-color: rgba(205, 155, 225, 0.6);
	}

	/* 테이블 */
	table tr {
		background-color: #fff;
	}

	table tr th {
		background-color: rgba(168, 156, 200, 0.6);
	}

	table tr td {
		border: 1px solid #ccc;
		text-align: center;
	}

	/* 등록삭제 버튼 */
	.input1 {
		border: 1px;
		width: 20%;
		margin: auto;
		text-align: center;
		margin-top: 20px;
	}

	.input1 .button {
		font-family: "Wanted Sans Variable";
		font-size: 18px;
		background-color: rgba(155, 178, 225, 0.6);
		width: 50px;
		height: 30px;
		border: 0;
		border-radius: 5px;
	}

	.input1 .button:hover {
		background-color: rgba(205, 155, 225, 0.6);
	}

	/* 쪽이동 */
	.nextpage {
		border: 1px;
		width: 20%;
		margin: auto;
		text-align: center;
		margin-top: 20px;
	}
</style>

<body>
	<!-- header -->
	<header></header>

	<button type="button" id="book_add">책 추가</button>
	<!-- 검색창   -->
	<div class="search">
		<select class="view_count" onchange="changeViewCount(this.value)">
			<option value="10">10개씩</option>
			<option value="20">20개씩</option>
			<option value="30">30개씩</option>
		</select>
		<select class="search_opt_list" id="search_option" onchange="handleSearchOption()">
			<option value="책이름">책이름</option>
			<option value="청구기호">청구기호</option>
			<option value="등록번호">등록번호</option>
		</select>
		<input type="text" name="search" class="textbox" id="input_todo">
		<button type="button" class="button" id="todo_search" onclick="search()">검색
		</button>
	</div>

	<!-- table -->
	<form name="myform" method="post" action="">
		<div>
			<table border="0" width="1200" height="200" align="center" cellpadding="5" cellspacing="1" bgcolor="cccccc"
				id="todo_booktable">
				<tr>
					<th width="100">책이름</th>
					<th width="100">저자</th>
					<th width="100">발행년</th>
					<th width="100">청구기호</th>
					<th width="100">등록번호</th>
					<th width="100">소장기관</th>
					<th width="100">등록날짜</th>
					<th width="100">예약</th>
					<th width="100">대출상태</th>
					<th width="100">
						도서폐기
						<input type="checkbox"  id="select_all">
					</th>
				</tr>
				<tr>
					<td>java중급</td>
					<td>최민수강사님</td>
					<td>2023-05-01</td>
					<td>12215</td>
					<td>10</td>
					<td>천안도서관</td>
					<td>2024-02-02</td>
					<td>예약</td>
					<td>대출중</td>
					<td><input type="checkbox" name="check"></td>
				</tr>

			</table>
	</form>
	</div>

	<!-- 등록 삭제 -->
	<div class="input1">
		<button type="button" class="button" onclick="bookadd_popup()">등록</button>
		<button type="button" class="button" id="button_cancle">폐기</button>
	</div>

	<!-- 쪽이동 -->
	<div class="nextpage">
		<input type="button" value="<">
		<input type="button" value="1">
		<input type="button" value="2">
		<input type="button" value="3">
		<input type="button" value="4">
		<input type="button" value=">">
	</div>


	<!-- 헤더를 덮어씌우는 자바스크립트 -->
	<script src="../js/header_admin.js"></script>

</body>

</html>